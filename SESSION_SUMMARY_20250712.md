# YouTube Timeline Generator 開発セッション記録

日時: 2025年1月12日
場所: C:\Users\ya211\OneDrive\ドキュメント\movie_auto_screenshot

## セッション概要

YouTube動画のタイムライン自動生成ツールの開発を行いました。当初は技術系動画向けのツールとして開発を開始し、その後エンタメ動画向けの機能を追加しました。

## 開発の流れ

### 1. 初期要件定義（17:47頃）

**ユーザーの要望:**
- YouTubeのURLを入力として、動画の要所要所の話が切り替わる場面を一覧化
- タイムラインを自動作成するツール

**決定した仕様:**
- 対象: 技術系動画
- 粒度: 数十秒単位
- 出力: テキストファイル
- 処理: 事後処理で品質重視

### 2. 要件定義書の作成

`requirements.md`を作成し、以下の内容を定義:
- 機能要件（動画情報取得、セクション検出、タイムライン生成）
- 非機能要件（処理時間、精度、メモリ使用量）
- 技術スタック（Python + yt-dlp + Whisper + FFmpeg）

### 3. MVP実装（17:50-18:00）

チケット駆動開発で以下のモジュールを実装:

1. **プロジェクト構成**
   ```
   youtube_timeline_generator/
   ├── src/
   ├── tests/
   ├── output/
   ├── temp/
   └── logs/
   ```

2. **実装モジュール**
   - `video_downloader.py`: YouTube動画情報取得
   - `audio_extractor.py`: FFmpegで音声抽出
   - `speech_recognizer.py`: Whisperで音声認識
   - `section_detector.py`: 話題の切り替わり検出
   - `timeline_writer.py`: タイムライン出力
   - `main.py`: メインスクリプト（CLI）

### 4. FFmpeg関連の問題対応（18:00頃）

**問題:** FFmpegがインストールされていないエラー

**対応:**
- `INSTALL_FFMPEG_WINDOWS.md`: インストール手順書作成
- `PATH_SETUP_GUIDE.md`: 詳細なPATH設定ガイド作成

### 5. エンタメモード追加（19:09-19:30）

**ユーザーの新要望:**
「エンタメ用のプログラムも作って欲しい。声が大きくなっているところや笑い声などでタイムラインを作成」

**実装内容:**
1. **音声解析モジュール** (`audio_analyzer.py`)
   - 音量ピーク検出
   - サプライズ検出（静寂→大音量）
   - 持続的高音量検出

2. **イベント検出モジュール** (`event_detector.py`)
   - 笑い声検出
   - 拍手検出
   - 歓声検出

3. **エンタメ用セクション検出** (`entertainment_detector.py`)
   - イベントの統合
   - 絵文字付きタイムライン生成

4. **メインスクリプト改修**
   - `--mode` オプション追加（tech/entertainment）
   - モード別処理の実装

### 6. 依存関係の問題対応（19:30頃）

**問題:** librosaモジュールが見つからない

**対応:** 
```bash
pip install -r requirements.txt
```

### 7. エンタメモード改良（19:36）

**ユーザーの要望:**
「何の話題で盛り上がっているのかわかるように修正して欲しい」

**実装内容:**
- エンタメモードでも音声認識を実行
- 盛り上がりポイントの会話内容を抽出
- タイムラインに内容を表示（例：`🎉 大きな盛り上がり「すごい！これはヤバい！」`）

## 最終成果物

### 1. ツールの特徴

**技術系モード（デフォルト）**
- Whisperによる高精度音声認識
- 話題の切り替わりを自動検出
- 詳細なテキスト内容付きタイムライン

**エンタメモード**
- 音声特徴に基づくハイライト検出
- 笑い声、拍手、歓声の自動検出
- 盛り上がりポイントの内容表示
- 絵文字付きの見やすい出力

### 2. 使用方法

```bash
# 技術系動画（デフォルト）
python src/main.py <YouTube URL>

# エンタメ動画
python src/main.py <YouTube URL> --mode entertainment

# オプション指定
python src/main.py <URL> -m entertainment --volume-threshold 1.2 -v
```

### 3. 出力例

**技術系モード:**
```
00:00 - イントロダクション
02:15 - 環境構築の説明
05:30 - 基本概念の解説
```

**エンタメモード:**
```
00:45 - 🎉 大きな盛り上がり「すごい！これはヤバい！」
02:30 - 😱 サプライズ「えっ！？マジで！？」
05:15 - 😂 笑い声「それはないでしょ〜」
```

## 作成したファイル一覧

### ドキュメント
- `requirements.md`: 要件定義書
- `README.md`: 使用方法とプロジェクト説明
- `ENTERTAINMENT_MODE.md`: エンタメモード仕様書
- `INSTALL_FFMPEG_WINDOWS.md`: FFmpegインストールガイド
- `PATH_SETUP_GUIDE.md`: PATH設定詳細ガイド

### ソースコード
- `src/main.py`: メインスクリプト
- `src/video_downloader.py`: 動画情報取得
- `src/audio_extractor.py`: 音声抽出
- `src/speech_recognizer.py`: 音声認識
- `src/section_detector.py`: セクション検出（技術系）
- `src/audio_analyzer.py`: 音声特徴解析
- `src/event_detector.py`: イベント検出
- `src/entertainment_detector.py`: エンタメ用セクション検出
- `src/timeline_writer.py`: タイムライン出力

### 設定ファイル
- `requirements.txt`: Python依存関係
- `.gitignore`: Git除外設定

## チケット管理

合計20個のチケットを作成・完了:
- プロジェクト構成: 8チケット
- FFmpeg関連: 2チケット
- エンタメモード: 6チケット
- その他: 4チケット

## 技術的なポイント

1. **モジュール設計**: 各機能を独立したモジュールとして実装し、保守性を確保
2. **エラーハンドリング**: FFmpegの存在確認、適切なエラーメッセージ
3. **拡張性**: モード切り替えによる異なる処理の実装
4. **ユーザビリティ**: CLIでの使いやすさ、進捗表示、わかりやすい出力

## 今後の拡張候補

1. Webインターフェース
2. リアルタイム処理モード
3. 複数動画の一括処理
4. より高度な内容要約機能
5. 映像解析の追加（画面変化検出）

## まとめ

約2時間のセッションで、YouTube動画のタイムライン自動生成ツールを完成させました。技術系動画向けの音声認識ベースの機能から始まり、エンタメ動画向けの音声特徴解析機能まで実装し、両方のニーズに対応できるツールとなりました。