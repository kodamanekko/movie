# エンターテインメント動画モード仕様書

## 概要
エンタメ動画（ゲーム実況、バラエティ、コメディ等）向けのタイムライン生成機能。
音声の特徴（音量変化、笑い声、拍手、歓声など）を検出してハイライトポイントを抽出。

## 検出対象

### 1. 音量ベースの検出
- **盛り上がりポイント**: 平均音量から大きく逸脱した箇所
- **静寂からの急激な変化**: サプライズや驚きの瞬間
- **持続的な高音量**: 激しいアクションシーン

### 2. 音声パターンの検出
- **笑い声**: 特徴的な周波数パターン
- **拍手**: 短い衝撃音の連続
- **歓声・叫び声**: 高周波数成分の急増
- **BGM/効果音の変化**: 急激な音楽の変化

### 3. 会話パターンの検出
- **複数人の同時発話**: 盛り上がっている場面
- **早口になる部分**: 興奮している場面
- **間（ま）の後の発話**: 重要な発言の可能性

## 技術実装

### 必要なライブラリ（追加分）
```
librosa>=0.10.0  # 音声解析
scipy>=1.11.0    # 信号処理
matplotlib>=3.7.0 # 可視化（デバッグ用）
```

### アルゴリズム概要
1. **音声の前処理**
   - ノイズ除去
   - 正規化

2. **特徴量抽出**
   - RMS（Root Mean Square）エネルギー
   - スペクトログラム
   - MFCC（メル周波数ケプストラム係数）
   - ゼロ交差率

3. **イベント検出**
   - ピーク検出アルゴリズム
   - 閾値ベースの判定
   - 機械学習モデル（将来的な拡張）

## 出力例

```
エンターテインメント動画タイムライン
==================================================
URL: https://www.youtube.com/watch?v=xxxxx
タイトル: 【ゲーム実況】恐怖のホラーゲーム
総再生時間: 25:30

ハイライトタイムライン
==================================================
00:45 - 🎉 オープニングの盛り上がり
02:30 - 😱 大きな驚き（音量ピーク: +15dB）
05:15 - 🤣 爆笑シーン（笑い声検出）
08:20 - 👏 拍手・歓声
12:45 - 🔥 激しいアクションシーン（持続的高音量）
15:30 - 😂 みんなで大笑い（複数人の笑い声）
18:00 - 😲 サプライズ展開（静寂→急激な音量上昇）
22:15 - 🎊 クライマックス（全体的な盛り上がり）
```

## パラメータ設定

```yaml
# config.yaml
entertainment_mode:
  # 音量検出
  volume_threshold: 1.5  # 平均音量の何倍を閾値とするか
  peak_duration: 2.0     # ピークとみなす最小持続時間（秒）
  
  # 笑い声検出
  laughter_detection: true
  laughter_confidence: 0.7  # 検出信頼度の閾値
  
  # 拍手検出
  applause_detection: true
  applause_min_duration: 1.0  # 最小持続時間（秒）
  
  # セクション分割
  min_section_gap: 10.0  # セクション間の最小間隔（秒）
  merge_nearby_events: true  # 近接イベントの統合
  merge_threshold: 5.0   # 統合する時間閾値（秒）
```

## 使用方法

```bash
# エンタメモードで実行
python src/main.py <YouTube URL> --mode entertainment

# パラメータをカスタマイズ
python src/main.py <YouTube URL> --mode entertainment --volume-threshold 2.0

# 可視化付き（デバッグ用）
python src/main.py <YouTube URL> --mode entertainment --visualize
```